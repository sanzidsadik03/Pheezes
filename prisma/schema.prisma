generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Product {
  id          Int                 @id @default(autoincrement())
  name        String
  description String?
  variations  ProductVariation[]
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
}

model ProductVariation {
  id         Int         @id @default(autoincrement())
  name       String      // e.g. "Size L", "Blue"
  quantity   Int
  price      Float
  productId  Int
  product    Product     @relation(fields: [productId], references: [id], onDelete: Cascade)
  orderItems OrderItem[]
}

model Order {
  id              Int         @id @default(autoincrement())
  customerName    String?
  customerContact String?
  customerAddress String?
  details         String?     // Manual customer info and order details
  status          String      // PENDING, PROCESSING, DISPATCHED, RETURNED
  totalAmount     Float
  advance         Float       @default(0)
  items           OrderItem[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model OrderItem {
  id                 Int              @id @default(autoincrement())
  orderId            Int
  order              Order            @relation(fields: [orderId], references: [id], onDelete: Cascade)
  productVariationId Int
  productVariation   ProductVariation @relation(fields: [productVariationId], references: [id])
  quantity           Int
  price              Float
}

model Transaction {
  id          Int      @id @default(autoincrement())
  type        String   // INCOME, EXPENSE
  amount      Float
  description String?
  account     String   @default("MISC") // BKASH, MISC
  date        DateTime @default(now())
}
